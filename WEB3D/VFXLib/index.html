<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>

    <script src="./lib/three/build/three.min.js"></script>
    <script src="./lib/three/examples/js/controls/TrackballControls.js"></script>
    <script src="./ParticleSystemGPU.js"></script>
    <script src="./ParticleSystemBasic.js"></script>
    <script src="./lib/Stats.js"></script>

</head>
<body>

    <script>

        var clock = new THREE.Clock();

        var stats = new Stats();
        stats.domElement.style.position = 'absolute';
        stats.domElement.style.left = '0px';
        stats.domElement.style.top = '0px';
        stats.domElement.style.width = '90px'
        document.body.appendChild(stats.domElement);


        var scene, camera, renderer;
        var controls;


        var particleSystem;


        function init() {

            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0xaaaaaa);

            document.body.appendChild(renderer.domElement);

            //
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 100000 );
            camera.position.z = 2000;

            controls = new THREE.TrackballControls( camera );

            controls.rotateSpeed = 10.0;
            controls.zoomSpeed = 5;
            controls.panSpeed = 2;

            controls.noZoom = false;
            controls.noPan = false;

            controls.staticMoving = true;
            controls.dynamicDampingFactor = 0.3;


            scene = new THREE.Scene();

            window.addEventListener( 'resize', onWindowResize, false );

            particleSystem = new ParticleSystemBasic();
            particleSystem.initialize(100000);

            scene.add(particleSystem.getMesh());


        var sphereGeometry = new THREE.SphereGeometry( 300, 32, 16 );
        var sphereMaterial = new THREE.MeshLambertMaterial( { color: 0xff0000} );

        var sphereMesh = new THREE.Mesh(sphereGeometry, sphereMaterial);
        sphereMesh.position.x = 500;
        sphereMesh.position.y = -200;


        scene.add(sphereMesh);

        }

        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            renderer.setSize( window.innerWidth, window.innerHeight );

            controls.handleResize();
        }

        function animate() {

            stats.begin();


            var cen = new THREE.Vector3(0,500,0);
            var rad = 50;

            particleSystem.addParticlesFromSphere(10, cen, rad);


            particleSystem.updateParticles(clock.getDelta());

            controls.update();

            renderer.clear();
            renderer.clearDepth();
            renderer.render( scene, camera );


            stats.end();

            requestAnimationFrame( animate );
         }

        init();

        animate();

    </script>

</body>
</html>